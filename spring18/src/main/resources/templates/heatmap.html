<!DOCTYPE html>
<html>
  <head>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 2,
          center: {lat: -33.865427, lng: 151.196123},
          mapTypeId: 'terrain'
        });

        // Create a <script> tag and set the USGS URL as the source.
        var script = document.createElement('script');

        // This example uses a local copy of the GeoJSON stored at
        // http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.geojsonp

        var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
      eqfeed_callback(this.responseText);
   }
};
xhttp.open("GET", "http://127.0.0.1:8080/clicks", true);
xhttp.send();



      }

      function eqfeed_callback(request) {

  		var longmap = {
          657:-96.6783449,
  510:-81.5190053,
  525:-84.155741,
  644:-92.4451371,
  583:-83.4327528,
  574:-78.3947359,
  634:-101.8312969,
  679:-93.625622,
  743:-149.9002778,
  567:-82.6501332,
  658:-88.4153847,
  524:-84.3879824,
  500:-70.2311655,
  520:-81.975,
  611:-92.9746367,
  635:-97.7430608,
  800:-119.0187125,
  512:-76.6121893,
  537:-68.7778138,
  716:-91.154551,
  563:-85.1797142,
  513:-83.8888647,
  821:-121.3153096,
  756:-108.5006904,
  502:-75.9179738,
  630:-86.80249,
  675:-88.9936873,
  757:-116.237651,
  736:-86.4436018,
  754:-111.050499,
  625:-96.3699632,
  514:-78.8783689,
  540:-85.4011619,
  510:-81.378447,
  648:-88.9548001,
  519:-79.9309216,
  517:-80.8431267,
  584:-78.4766781,
  575:-85.3096801,
  602:-87.6500523,
  515:-84.5030556,
  531:-82.4106862,
  546:-81.0348144,
  522:-84.9877094,
  535:-82.9987942,
  600:-97.396381,
  542:-84.1916069,
  691:-86.9833417,
  648:-88.9548001,
  751:-104.9847034,
  505:-83.0457538,
  687:-102.7896242,
  606:-85.3904888,
  560:-78.898619,
  702:-91.4984941,
  771:-115.5630514,
  628:-92.665901,
  765:-106.4869314,
  588:-85.9766671,
  565:-76.8077338,
  516:-80.085059,
  801:-123.0867536,
  802:-124.1636729,
  649:-87.5558482,
  745:-147.7163889,
  560:-78.8783585,
  691:-87.677251,
  528:-80.1433786,
  548:-80.3256056,
  686:-86.618842,
  509:-85.1288597,
  623:-97.3208496,
  592:-82.3248262,
  798:-104.710419,
  755:-111.3008083,
  647:-91.0617735,
  746:-89.0928155,
  511:-77.7199932,
  569:-78.8689155,
  533:-72.6850932,
  766:-112.027031,
  543:-72.6162009,
  744:-157.8583333,
  618:-95.3830615,
  564:-82.445154,
  678:-97.9297743,
  527:-86.1580423,
  637:-91.5162792,
  639:-88.8139469,
  718:-90.1848103,
  561:-81.655651,
  604:-92.1735164,
  734:-90.704279,
  747:-134.4197222,
  616:-94.5785667,
  722:-99.083107,
  810:-119.1372338,
  717:-91.394372,
  631:-92.5832496,
  813:-121.7816704,
  557:-83.9207392,
  582:-86.8752869,
  642:-92.0198427,
  643:-93.2173758,
  551:-84.5555347,
  749:-99.5075421,
  839:-115.172816,
  710:-89.1306124,
  627:-98.3903305,
  541:-84.4951359,
  558:-84.1052256,
  709:-94.7404891,
  803:-118.2436849,
  529:-85.759407,
  651:-101.8551665,
  709:-94.729097,
  573:-79.1422464,
  503:-83.6324022,
  669:-89.4012302,
  506:-71.4547891,
  737:-93.9993996,
  553:-87.395417,
  636:-98.2300124,
  534:-80.6081089,
  640:-90.0489801,
  711:-88.703656,
  633:-102.0779146,
  617:-87.9064736,
  762:-113.9939982,
  725:-98.0297992,
  862:-120.9968782,
  682:-90.5151342,
  698:-86.2999689,
  773:-107.8761738,
  632:-88.9031201,
  570:-78.8866943,
  709:-94.6554874,
  571:-81.7948103,
  659:-86.7844432,
  521:-70.934205,
  533:-72.9281577,
  622:-90.0705556,
  501:-74.0059729,
  544:-76.428003,
  740:-100.7654232,
  559:-81.1487135,
  650:-97.5164276,
  652:-95.999258,
  804:-116.5452921,
  656:-85.6602058,
  597:-81.5615135,
  686:-87.2169149,
  686:-87.2169149,
  556:-77.4019267,
  504:-75.163789,
  753:-112.0740373,
  693:-92.0031955,
  603:-94.70496,
  508:-79.9958864,
  523:-73.4529124,
  758:-112.4455344,
  692:-93.939947,
  820:-122.6762071,
  552:-68.0158615,
  752:-104.6091409,
  764:-103.2310149,
  868:-122.3916754,
  811:-119.8138027,
  705:-89.4120753,
  767:-108.3801036,
  538:-77.6155567,
  610:-89.0939952,
  670:-94.1185366,
  828:-121.6555013,
  576:-75.5993692,
  770:-111.8910474,
  661:-100.4370375,
  641:-98.4936282,
  825:-117.1572551,
  807:-121.8949555,
  855:-120.6596156,
  790:-105.937799,
  539:-82.5306527,
  507:-81.0998342,
  759:-103.660709,
  577:-75.6624122,
  698:-87.0211007,
  612:-93.7501789,
  789:-110.2772856,
  624:-96.4003069,
  725:-96.700327,
  881:-117.4260466,
  619:-93.2982436,
  648:-88.9548001,
  638:-94.8363889,
  609:-90.224967,
  613:-93.086075,
  539:-82.667619,
  554:-80.6339638,
  676:-92.1040796,
  662:-100.4059384,
  555:-76.1474244,
  819:-122.4442906,
  581:-87.4139092,
  530:-83.9787808,
  547:-83.555212,
  605:-95.6780371,
  532:-73.6917851,
  789:-110.926479,
  671:-95.992775,
  760:-114.4608711,
  526:-75.232664,
  724:-98.0031547,
  626:-97.0035982,
  866:-119.2920585,
  511:-77.0363658,
  545:-77.0521742,
  549:-75.9107565,
  673:-88.6503254,
  598:-80.467313,
  627:-98.3088441,
  687:-103.6179745,
  550:-77.9447102,
  518:-80.244216,
  566:-76.727745,
  536:-80.6495194,
  596:-82.0131924};
  	    var latmap = {
          657:34.774531,
          510:41.0814447,
          525:31.5785074,
          644:31.3112936,
          583:45.0616794,
          574:40.5186809,
          634:35.2219971,
          679:42.02335,
          743:61.2180556,
          567:34.5034394,
          658:44.2619309,
          524:33.7489954,
          500:44.0978509,
          520:33.47,
          611:43.6666296,
          635:30.267153,
          800:35.3732921,
          512:39.2903848,
          537:44.8011821,
          716:30.4507462,
          563:42.3211522,
          513:43.5944677,
          821:44.0581728,
          756:45.7832856,
          502:42.0986867,
          630:33.5206608,
          675:40.4842027,
          757:43.613739,
          736:36.9903199,
          754:45.68346,
          625:30.6743643,
          514:42.8864468,
          540:44.2519526,
          510:40.7989473,
          648:39.8403147,
          519:32.7765656,
          517:35.2270869,
          584:38.0293059,
          575:35.0456297,
          602:41.850033,
          515:39.1361111,
          531:36.472723,
          546:34.0007104,
          522:32.4609764,
          535:39.9611755,
          600:27.8005828,
          542:39.7589478,
          691:34.6059253,
          648:39.8403147,
          751:39.7391536,
          505:42.331427,
          687:46.8791756,
          606:31.2232313,
          560:35.9940329,
          702:44.811349,
          771:32.792,
          628:33.210973,
          765:31.7587198,
          588:41.6819935,
          565:42.0897965,
          516:42.1292241,
          801:44.0520691,
          802:40.8020712,
          649:37.9747644,
          745:64.8377778,
          560:35.0526641,
          691:34.79981,
          528:26.1223084,
          548:27.4467056,
          686:30.4057552,
          509:41.1306041,
          623:32.725409,
          592:29.6516344,
          798:47.108491,
          755:47.5002354,
          647:33.4101161,
          746:30.3674198,
          511:39.6417629,
          569:38.4495688,
          533:41.7637111,
          766:46.595805,
          543:42.2042586,
          744:21.3069444,
          618:29.7628844,
          564:38.4192496,
          678:38.0608445,
          527:39.7683765,
          637:41.677204,
          639:35.6145169,
          718:32.2987573,
          561:30.3321838,
          604:38.5767017,
          734:35.8422967,
          747:58.3019444,
          616:39.0997265,
          722:40.699959,
          810:46.2112458,
          717:40.402525,
          631:40.1947539,
          813:42.224867,
          557:35.9606384,
          582:40.4167022,
          642:30.2240897,
          643:30.2265949,
          551:42.732535,
          749:27.506407,
          839:36.114646,
          710:31.6940509,
          627:34.6086854,
          541:38.0317136,
          558:40.742551,
          709:32.5007037,
          803:34.0522342,
          529:38.2542376,
          651:33.5778631,
          709:31.3382406,
          573:37.4137536,
          503:32.8406946,
          669:43.0730517,
          506:42.9956397,
          737:44.1635775,
          553:46.5435442,
          636:26.2034071,
          534:28.0836269,
          640:35.1495343,
          711:32.3643098,
          633:31.9973456,
          617:43.0389025,
          762:46.872146,
          725:43.7094283,
          862:37.6390972,
          682:41.5067003,
          698:32.3668052,
          773:38.4783198,
          632:38.3172714,
          570:33.6890603,
          709:31.6035129,
          571:26.1420358,
          659:36.1658899,
          521:41.6362152,
          533:41.3081527,
          622:29.9647222,
          501:40.7142691,
          544:36.9787588,
          740:41.1238873,
          559:37.9723339,
          650:35.4675602,
          652:41.254006,
          804:33.8302961,
          656:30.1588129,
          597:39.2667418,
          686:30.421309,
          686:30.421309,
          556:37.2279279,
          504:39.952335,
          753:33.4483771,
          693:34.2284312,
          603:37.410884,
          508:40.4406248,
          523:44.6994873,
          758:42.8713032,
          692:29.8849504,
          820:45.5234515,
          552:46.681153,
          752:38.2544472,
          764:44.0805434,
          868:40.5865396,
          811:39.5296329,
          705:45.6366228,
          767:43.0249592,
          538:43.1547845,
          610:42.2711311,
          670:36.3320196,
          828:36.6777372,
          576:38.3606736,
          770:40.7607793,
          661:31.4637723,
          641:29.4241219,
          825:32.7153292,
          807:37.3393857,
          855:35.2827524,
          790:35.6869752,
          539:27.3364347,
          507:32.0835407,
          759:41.86714,
          577:41.408969,
          698:32.4073589,
          612:32.5251516,
          789:31.5455001,
          624:42.4999942,
          725:43.5499749,
          881:47.6587802,
          619:37.215326,
          648:39.8403147,
          638:39.7577778,
          609:38.646991,
          613:44.944167,
          539:27.782254,
          554:40.3697905,
          676:46.7207737,
          662:32.4709519,
          555:43.0481221,
          819:47.2528768,
          581:39.4667034,
          530:30.8365815,
          547:41.6639383,
          605:39.0483336,
          532:42.7284117,
          789:32.2217429,
          671:36.1539816,
          760:42.5629668,
          526:43.100903,
          724:46.9233129,
          626:28.8052674,
          866:36.3302284,
          511:38.8951118,
          545:35.5465517,
          549:43.9747838,
          673:33.6076186,
          598:39.0384274,
          627:33.6953791,
          687:48.1469683,
          550:34.2257255,
          518:36.0998596,
          566:39.9625984,
          536:41.0997803,
          596:39.9403453};
  	var text  = request.replace("[", "").replace("]","");
      var re=/\r\n|\n\r|\n|\r/g;

  	var arrayoflines=text.split("},");

      var j;
      var i;
      dmas = [];
      var heatmapData = [];
      for(j = 0; j < arrayoflines.length-1; j++) {
      	  var json = JSON.parse(arrayoflines[j] + "}");
          var latLng = new google.maps.LatLng(latmap[json["dma"]],longmap[json["dma"]]);
            heatmapData.push(latLng);

      }


        var heatmap = new google.maps.visualization.HeatmapLayer({
          data: heatmapData,
          dissipating: false,
          map: map
        });
      }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPUlUFFLUNO_MoYsfw7-W_W5xKASvVAmc&libraries=visualization&callback=initMap">
    </script>

  </body>
</html>
